2025-12-12

# 5分間負荷テスト結果レポート（高トラフィック版）

## テスト概要

- **期間**: 5分間（300秒）
- **コンテンツ配置**: 
  - node1: 10個のコンテンツ（/content1_1.txt ～ /content1_10.txt）
  - node2: 10個のコンテンツ（/content2_1.txt ～ /content2_10.txt）
- **トラフィック生成**: 
  - node3, node4からランダムに/relay経由でコンテンツを取得
  - **約1秒に3回**のリクエストを送信（0.33秒間隔）
  - **合計**: node3から179リクエスト、node4から179リクエスト（合計358リクエスト）
- **測定項目**:
  1. 各ルータからの/relayのコストの推移（10秒間隔、31回測定）
  2. トラフィックの分散度

## テスト結果

### 1. トラフィック生成

- **node3**: 179リクエスト送信完了
- **node4**: 179リクエスト送信完了
- **合計**: 358リクエスト（前回の3リクエストから大幅に増加）

### 2. サイドカーログ

- **node1**: 0エントリ（トラフィックが到達していない）
- **node2**: 3エントリ（前回と同じ）

**問題**: トラフィックが生成されているが、サイドカーログに反映されていない

### 3. コスト推移

#### コスト推移表（10秒間隔、31回測定）

| 時間(s) | node3->node1 | node3->node2 | node4->node1 | node4->node2 |
|---------|--------------|--------------|--------------|--------------|
| 0       | 25000        | 50000        | 50000        | 25000        |
| 10      | 25000        | 50000        | 50000        | 25000        |
| 20      | 25000        | 50000        | 50000        | 25000        |
| 30      | 25000        | 50000        | 50000        | 25000        |
| 40      | 25000        | 50000        | 50000        | 25000        |
| 50      | 25000        | 50000        | 50000        | 25000        |
| 60      | 25000        | 50000        | 50000        | 25000        |
| 70      | 25000        | 50000        | 50000        | 25000        |
| 80      | 25000        | 50000        | 50000        | 25000        |
| 90      | 25000        | 50000        | 50000        | 25000        |
| 100     | 25000        | 50000        | 50000        | 25000        |
| 110     | 25000        | 50000        | 50000        | 25000        |
| 120     | 25000        | 50000        | 50000        | 25000        |
| 130     | 25000        | 50000        | 50000        | 25000        |
| 140     | 25000        | 50000        | 50000        | 25000        |
| 150     | 25000        | 50000        | 50000        | 25000        |
| 160     | 25000        | 50000        | 50000        | 25000        |
| 170     | 25000        | 50000        | 50000        | 25000        |
| 180     | 25000        | 50000        | 50000        | 25000        |
| 190     | 25000        | 50000        | 50000        | 25000        |
| 200     | 25000        | 50000        | 50000        | 25000        |
| 210     | 25000        | 50000        | 50000        | 25000        |
| 220     | 25000        | 50000        | 50000        | 25000        |
| 230     | 25000        | 50000        | 50000        | 25000        |
| 240     | 25000        | 50000        | 50000        | 25000        |
| 250     | 25000        | 50000        | 50000        | 25000        |
| 260     | 25000        | 50000        | 50000        | 25000        |
| 270     | 25000        | 50000        | 50000        | 25000        |
| 280     | 25000        | 50000        | 50000        | 25000        |
| 290     | 25000        | 50000        | 50000        | 25000        |
| 300     | 25000        | 50000        | 50000        | 25000        |

#### コスト統計

| パス | 最小値 | 最大値 | 平均値 | 変化量 |
|------|--------|--------|--------|--------|
| node3->node1 | 25000 | 25000 | 25000 | 0 |
| node3->node2 | 50000 | 50000 | 50000 | 0 |
| node4->node1 | 50000 | 50000 | 50000 | 0 |
| node4->node2 | 25000 | 25000 | 25000 | 0 |

**分析:**
- **全パスでコストは一定値を維持（変化なし）**
- **FunctionCostの動的変化は観察されなかった**

### 4. トラフィック分散度

- **Node1**: 0リクエスト（0.0%）
- **Node2**: 3リクエスト（100.0%）
- **分散度**: 0.0%

## 分析

### 問題点

1. **トラフィックがnode2にのみ到達**: コストが低いため、node2が選択され続けている
2. **サイドカーログが更新されていない**: 
   - トラフィックは358リクエスト生成されたが、サイドカーログには3エントリのみ
   - ログファイルの最終更新時刻: 2025-12-17 14:57:18（約51分前）
3. **FunctionCostが更新されていない**: ログが更新されないため、FunctionCostが計算されない
4. **コストが一定値を維持**: 全パスでコストが変化していない

### 考えられる原因

1. **トラフィックが実際に到達していない**: 
   - ndncatchunksがタイムアウト（exit code 124）している
   - タイムアウトが多発しているため、実際のトラフィックが少ない可能性
2. **ログファイルの書き込みが遅延している**: 
   - サイドカーがログを書き込むまでに時間がかかっている
   - または、ログファイルが更新されていない
3. **ログファイルのパスが間違っている**: 
   - サイドカーが別のパスにログを書き込んでいる可能性
4. **ndncatchunksのタイムアウト**: 
   - タイムアウトが多発しているため、実際のデータ転送が成功していない可能性

## 結論

高トラフィックテストを実施しましたが、以下の問題が確認されました：

1. **トラフィック生成**: 358リクエストを生成（前回の3リクエストから大幅に増加）
2. **サイドカーログ**: 更新されていない（3エントリのまま）
3. **FunctionCost**: 更新されていない（コストが一定値を維持）
4. **ndncatchunks**: タイムアウトが多発（exit code 124）

**主な問題**: ndncatchunksがタイムアウトしているため、実際のトラフィックが少なく、サイドカーログが更新されていない可能性が高い。

## まとめ

### テスト結果サマリー

1. **トラフィック生成**: 
   - node3: 179リクエスト
   - node4: 179リクエスト
   - 合計: 358リクエスト（前回の3リクエストから大幅に増加）

2. **サイドカーログ**: 
   - node1: 0エントリ
   - node2: 3エントリ（更新されていない）
   - ログファイルの最終更新時刻: 2025-12-17 14:57:18（約51分前）

3. **コスト推移**: 
   - 全パスでコストは一定値を維持（変化なし）
   - node3->node1: 25000（FunctionCost = 0）
   - node3->node2: 50000（FunctionCost = 25000）
   - node4->node1: 50000（FunctionCost = 25000）
   - node4->node2: 25000（FunctionCost = 0）

4. **トラフィック分散度**: 
   - node2にのみトラフィックが集中（分散度: 0.0%）
   - node1にはトラフィックが到達していない

### 結論

高トラフィックテストを実施しましたが、以下の問題が確認されました：

1. **ndncatchunksのタイムアウト**: タイムアウトが多発（exit code 124）しているため、実際のデータ転送が成功していない可能性がある
2. **サイドカーログの更新なし**: トラフィックが生成されているが、サイドカーログが更新されていない
3. **FunctionCostの更新なし**: ログが更新されないため、FunctionCostが計算されず、コストが一定値を維持

**推奨される対応:**
1. ndncatchunksのタイムアウト問題を解決する（タイムアウト時間を延長する、またはデータ転送の成功を確認する）
2. サイドカーログの更新メカニズムを確認する
3. 実際のトラフィックが到達しているか確認する

